#!/usr/bin/env python
# encoding: UTF-8

from os.path import realpath, dirname, join
import sys

sys.path.insert(0, join(dirname(realpath(sys.argv[0])), '..', 'src'))

import codecs
from optparse import OptionParser

from samovar.parser import Parser
from samovar.generator import Generator


if __name__ == '__main__':

    optparser = OptionParser(__doc__)
    optparser.add_option("--debug",
                         action="store_true",
                         help="Show state before and after each move")
    optparser.add_option("--length",
                         type=int, default=20,
                         help="How many events to generate in each scene")
    (options, args) = optparser.parse_args(sys.argv[1:])

    with codecs.open(args[0], 'r', encoding='UTF-8') as f:
        text = f.read()

    p = Parser(text)
    ast = p.world()
    if options.debug:
        print ast
    g = Generator(ast, debug=options.debug, length=options.length)
    g.generate()
